---
import Layout from '~/layouts/Layout.astro';
import { Image } from 'astro:assets';
import satispieLogo from '~/assets/images/satispie-logo.png';
import { stores } from '~/data/stores';

export const metadata = {
  title: 'Find SatisPie Locations Near You | Store Locator',
  description: 'Find retail locations that carry SatisPie\'s delicious all-butter pies. Search by ZIP code or browse our network of partner stores across the region.',
  keywords: 'SatisPie locations, pie store locator, find pies near me, retail locations, store finder',
  openGraph: {
    title: 'Find SatisPie Locations Near You',
    description: 'Locate retail stores carrying our delicious all-butter pies',
    image: satispieLogo.src,
    url: '/find-pies'
  }
};
---

<Layout metadata={metadata}>
  <main class="container mx-auto px-4 py-8">
    <!-- Hero Section -->
    <section class="text-center mb-12">
      <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
        Find SatisPie Locations
      </h1>
      <p class="text-xl text-gray-600 max-w-2xl mx-auto">
        Discover where to buy our delicious all-butter pies. Search by ZIP code or browse our network of partner stores.
      </p>
    </section>

    <!-- Search Section -->
    <section class="max-w-2xl mx-auto mb-12">
      <div class="bg-white rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-semibold mb-4">Find Stores Near You</h2>
        <div class="flex flex-col sm:flex-row gap-4">
          <input 
            type="text" 
            id="zipSearch" 
            placeholder="Enter ZIP code..."
            class="flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
          >
          <button 
            onclick="searchStores()"
            class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold"
          >
            Search
          </button>
        </div>
        <p class="text-sm text-gray-500 mt-2">
          Or browse all locations below
        </p>
      </div>
    </section>

    <!-- Map and Results Section -->
    <section class="grid lg:grid-cols-2 gap-8">
      <!-- Map Container -->
      <div class="order-2 lg:order-1">
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-2xl font-semibold mb-4">Store Map</h2>
          <div id="map" class="w-full h-96 rounded-lg bg-gray-100 flex items-center justify-center">
            <div class="text-center">
              <div class="text-gray-400 mb-2">
                <svg class="w-12 h-12 mx-auto" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path>
                </svg>
              </div>
              <p class="text-gray-500">Map loading...</p>
              <p class="text-sm text-gray-400">Google Maps integration</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Store List -->
      <div class="order-1 lg:order-2">
        <div class="bg-white rounded-lg shadow-lg p-6">
          <h2 class="text-2xl font-semibold mb-4">Store Locations</h2>
          <div id="storeList" class="space-y-4">
            {stores.map((store) => (
              <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                <div class="flex justify-between items-start mb-2">
                  <h3 class="font-semibold text-lg text-gray-900">{store.name}</h3>
                  <span class="text-sm text-green-600 font-medium">In Stock</span>
                </div>
                <p class="text-gray-600 mb-2">{store.address}</p>
                <p class="text-sm text-gray-500 mb-3">{store.hours}</p>
                <div class="flex flex-wrap gap-2 mb-3">
                  {store.features.map((feature) => (
                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">
                      {feature}
                    </span>
                  ))}
                </div>
                <div class="flex gap-2">
                  <a 
                    href={`tel:${store.phone}`}
                    class="text-blue-600 hover:text-blue-800 text-sm font-medium"
                  >
                    {store.phone}
                  </a>
                  <a 
                    href={`https://maps.google.com/?q=${encodeURIComponent(store.address)}`}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="text-blue-600 hover:text-blue-800 text-sm font-medium"
                  >
                    Get Directions
                  </a>
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    </section>

    <!-- Additional Info -->
    <section class="mt-12 text-center">
      <div class="bg-blue-50 rounded-lg p-8">
        <h2 class="text-2xl font-semibold mb-4">Don't See Your Area?</h2>
        <p class="text-gray-600 mb-6 max-w-2xl mx-auto">
          We're constantly expanding our retail network. If you don't see a store near you, 
          let us know and we'll work to bring SatisPie to your community.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a 
            href="/contact"
            class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold"
          >
            Request Store Addition
          </a>
          <a 
            href="/branded-products"
            class="px-6 py-3 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors font-semibold"
          >
            Learn About Wholesale
          </a>
        </div>
      </div>
    </section>
  </main>

  <script define:vars={{ stores }}>
    // Store data for JavaScript
    const storesData = stores;
    
    function searchStores() {
      const zipSearchElement = document.getElementById('zipSearch');
      if (zipSearchElement && zipSearchElement instanceof HTMLInputElement && zipSearchElement.value) {
        const zipCode = zipSearchElement.value;
        // In a real implementation, this would make an API call
        // For now, we'll just show all stores
        console.log(`Searching for stores near ${zipCode}`);
        alert(`Searching for stores near ${zipCode}...\n\nIn a full implementation, this would filter stores by distance.`);
      }
    }

    // Initialize map when page loads
    document.addEventListener('DOMContentLoaded', function() {
      // Google Maps API would be initialized here
      console.log('Store locator page loaded');
    });
  </script>
</Layout> 